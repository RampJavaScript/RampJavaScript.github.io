<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ramp — Single File</title>
  <style>
:root{
  --bg:#000;
  --fg:#fff;
  --muted:rgba(255,255,255,0.12);
  --bar-height:64px;
  --accent:#3aa0ff;
  --radius-md:10px;
  --transition-fast:120ms;
  --elev-1:0 6px 18px rgba(0,0,0,0.6);
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  color-scheme:dark;
}
html,body{
  height:100%;
  margin:0;
  background:radial-gradient(1200px 600px at 10% 10%, rgba(58,160,255,0.04), rgba(0,0,0,0) 6%), radial-gradient(1000px 500px at 90% 80%, rgba(176,125,255,0.03), rgba(0,0,0,0) 6%), var(--bg);
  color:var(--fg);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow-y:overlay;
  -webkit-overflow-scrolling:touch;
}
.hidden{ display:none !important; }
.center{ display:flex; align-items:center; justify-content:center; }
.screen{ min-height:calc(100vh - var(--bar-height)); display:flex; align-items:center; justify-content:center; padding:28px; box-sizing:border-box; position:relative; }
#start-screen{ inset:0; display:flex; align-items:center; justify-content:center; position:fixed; left:0; right:0; top:0; bottom:0; z-index:11000; background:linear-gradient(180deg, rgba(0,0,0,0.6), transparent); }
#loading-screen{ inset:0; display:flex; align-items:center; justify-content:center; position:fixed; z-index:12000; left:0; right:0; top:0; bottom:0; }
.start-card{ width:420px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); border:1px solid rgba(255,255,255,0.06); padding:20px; border-radius:12px; box-shadow:var(--elev-1); display:flex; flex-direction:column; gap:12px; }
.start-title{ font-size:20px; font-weight:900; }
.input{ background:transparent; color:var(--fg); border:1px solid rgba(255,255,255,0.06); padding:12px 14px; border-radius:8px; font-size:14px; outline:none; }
.btn{ padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; border:1px solid rgba(255,255,255,0.04); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); color:var(--fg); transition:transform var(--transition-fast), box-shadow var(--transition-fast); }
.btn.primary{ background:linear-gradient(180deg,var(--accent),#7de3ff); color:#000; border-color:rgba(58,160,255,0.12); }
.start-controls{ display:flex; gap:8px; justify-content:flex-end; }
.centered-info{ position:absolute; left:50%; top:18%; transform:translateX(-50%); text-align:center; z-index:1; pointer-events:none; }
#home-screen{ display:none; width:100%; height:100%; box-sizing:border-box; }
.clock{ font-size:56px; font-weight:700; line-height:1; letter-spacing:-0.6px; }
.date{ font-size:14px; opacity:0.9; margin-top:6px; }
.home-grid{ max-width:1200px; margin:0 auto; display:grid; grid-template-columns:1fr; gap:18px; padding:32px; box-sizing:border-box; }
.info-card{ background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.06); padding:16px; border-radius:12px; box-shadow:var(--elev-1); }
.app-panel{ position:fixed; left:0; right:0; top:0; height:calc(100vh - var(--bar-height)); display:flex; align-items:flex-start; justify-content:center; padding-top:12px; box-sizing:border-box; z-index:9000; pointer-events:auto; }
.panel-inner{ width:min(1200px,96%); height:calc(100% - 24px); margin-top:12px; display:flex; flex-direction:column; border-radius:12px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,0.65); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.06); backdrop-filter:blur(8px) saturate(120%); }
.panel-main{ height:100%; padding:20px; box-sizing:border-box; overflow:auto; }
.panel-top{ display:flex; align-items:center; justify-content:space-between; padding-bottom:8px; border-bottom:1px solid rgba(255,255,255,0.04); }
.panel-title{ font-weight:900; font-size:18px; }
.welcome-rect{ margin:8px 0 14px 0; padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015)); border:1px solid rgba(255,255,255,0.04); box-shadow:0 8px 24px rgba(0,0,0,0.5); }
.cat-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:18px; padding-top:12px; }
.cat-tile{ padding:20px; min-height:140px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); border-radius:10px; cursor:pointer; font-weight:900; display:flex; flex-direction:column; justify-content:center; align-items:flex-start; font-size:16px; transition:transform var(--transition-fast), box-shadow var(--transition-fast); }
.cat-tile:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.5); border-color:rgba(58,160,255,0.12); }
.appearance-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:16px; margin-top:12px; }
.wall-preview{ width:100%; height:160px; border-radius:12px; background-size:cover; background-position:center; border:1px solid rgba(255,255,255,0.06); display:flex; align-items:center; justify-content:center; color:var(--fg); font-weight:800; cursor:pointer; transition:transform var(--transition-fast), box-shadow var(--transition-fast); }
.wall-preview:hover{ transform:translateY(-6px); box-shadow:0 20px 50px rgba(0,0,0,0.6); }
.network-grid{ display:grid; grid-template-columns:repeat(1,1fr); gap:12px; margin-top:12px; }
.network-card{ padding:12px; border-radius:10px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.004)); border:1px solid rgba(255,255,255,0.03); }
.about-list{ display:flex; flex-direction:column; gap:8px; margin-top:12px; font-size:14px; }
.apps-grid{ display:grid; grid-template-columns:repeat(4,1fr); gap:12px; max-height:60vh; overflow:auto; padding:12px 0; }
.app-item{ background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.006)); border:1px solid rgba(255,255,255,0.04); padding:12px; border-radius:10px; text-align:center; cursor:pointer; font-weight:800; user-select:none; transition:transform var(--transition-fast), box-shadow var(--transition-fast); }
.app-item:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.55); }
.embed-area{ margin-top:12px; background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01)); border:1px solid rgba(255,255,255,0.04); border-radius:10px; overflow:hidden; display:flex; flex-direction:column; gap:8px; }
.embed-viewport{ width:100%; height:56vh; border:0; background:#000; }
.fullscreen-btn{ padding:8px 12px; border-radius:8px; background:linear-gradient(180deg, rgba(58,160,255,0.08), rgba(58,160,255,0.05)); border:1px solid rgba(255,255,255,0.04); cursor:pointer; }
:focus{ outline:none; }
.kbd{ padding:6px 8px; border-radius:6px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.04); font-weight:700; font-size:12px; display:inline-block; }
.sep{ height:1px; background:rgba(255,255,255,0.02); margin:8px 0; border-radius:2px; }
.bottom-bar{ position:fixed; left:0; right:0; bottom:0; height:var(--bar-height); display:flex; align-items:center; justify-content:center; padding:8px 20px; box-sizing:border-box; border-top:1px solid rgba(255,255,255,0.04); z-index:9999; background:linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.45)); backdrop-filter:blur(6px); }
.left-bar{ display:flex; gap:12px; align-items:center; margin-right:auto; padding-left:14px; }
.center-bar{ flex:1; display:flex; justify-content:center; }
.right-bar{ display:flex; gap:12px; align-items:center; justify-content:center; margin-left:auto; padding-right:14px; }
.dock-btn{ position:relative; background:transparent; border:none; padding:6px; border-radius:10px; cursor:pointer; width:56px; height:56px; display:inline-flex; align-items:center; justify-content:center; transition:background var(--transition-fast), transform var(--transition-fast); z-index:10000; color:var(--fg); }
.dock-btn:hover{ background:rgba(255,255,255,0.02); transform:translateY(-2px); }
.dock-underline{ position:absolute; left:12px; right:12px; bottom:8px; height:4px; border-radius:4px; background:transparent; opacity:0; transition:opacity var(--transition-fast), background var(--transition-fast); }
.dock-btn.active{ background:rgba(255,255,255,0.06); transform:translateY(-4px); box-shadow:0 10px 30px rgba(0,0,0,0.5); }
.dock-btn.active .dock-underline{ background:linear-gradient(90deg,var(--accent),#b07dff); opacity:1; }
.hide-bar .bottom-bar{ display:none !important; }
@keyframes spin{ to{ transform:rotate(360deg); } }
.spinner{ width:48px; height:48px; border-radius:50%; border:5px solid rgba(255,255,255,0.06); border-top-color:var(--fg); margin:12px auto; animation:spin 1.2s linear infinite; }
.meta-muted{ color:var(--muted); font-size:12px; }
@media (max-width:1100px){
  .apps-grid{ grid-template-columns:repeat(3,1fr); }
  .cat-grid{ grid-template-columns:1fr; }
  .appearance-grid{ grid-template-columns:1fr; }
}
@media (max-width:820px){
  .apps-grid{ grid-template-columns:repeat(2,1fr); }
  .panel-inner{ width:96%; padding:12px; }
}
@media (max-width:520px){
  .apps-grid{ grid-template-columns:1fr; }
  .dock-btn{ width:48px; height:48px; }
  .bottom-bar{ height:56px; }
}
  </style>
</head>
<body class="hide-bar">
  <div id="loading-screen" class="hidden" aria-hidden="true">
    <div class="loading-card">
      <div class="loading-title" style="font-weight:900;">Loading</div>
      <div class="spinner" aria-hidden="true"></div>
    </div>
  </div>

  <div id="start-screen">
    <div class="start-card" role="dialog" aria-labelledby="start-title">
      <div id="start-title" class="start-title">Welcome to Ramp</div>
      <input id="username" class="input" placeholder="Enter name" aria-label="Name" />
      <div class="start-controls">
        <button id="signInBtn" class="btn primary" type="button">Enter</button>
      </div>
    </div>
  </div>

  <div id="home-screen" class="hidden" role="application" aria-hidden="true">
    <div class="centered-info" id="centeredInfo" aria-hidden="false">
      <div id="homeClock" class="clock">--:--:--</div>
      <div class="date">Local time</div>
    </div>

    <main class="home-grid" role="main">
      <section class="info-card" aria-labelledby="home-title">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div id="home-title" style="font-weight:900;">Ramp Home</div>
          <div id="barTime" style="font-weight:800;">--:--:--</div>
        </div>
        <div class="meta-muted" style="margin-top:10px;opacity:0.9;">Quick launcher and apps</div>
      </section>

      <div id="app-panel-root" aria-live="polite"></div>
    </main>
  </div>

  <nav class="bottom-bar" id="bottomBar" role="navigation" aria-label="Taskbar">
    <div class="left-bar">
      <button class="dock-btn" data-app="apps" title="Apps" aria-label="Apps">
        <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="3" width="8" height="8" fill="white" opacity="0.95"></rect><rect x="13" y="3" width="8" height="8" fill="white" opacity="0.95"></rect></svg>
        <div class="dock-underline"></div>
      </button>

      <button class="dock-btn" data-app="games" title="Games" aria-label="Games">
        <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><circle cx="7" cy="8" r="3" fill="white" opacity="0.95"></circle><path d="M13 6h6v6h-6z" fill="white" opacity="0.95"></path></svg>
        <div class="dock-underline"></div>
      </button>
    </div>

    <div class="center-bar" aria-hidden="true"></div>

    <div class="right-bar">
      <button class="dock-btn" data-app="settings" title="Settings" aria-label="Settings">
        <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 8a4 4 0 100 8 4 4 0 000-8z" fill="white" opacity="0.95"></path></svg>
        <div class="dock-underline"></div>
      </button>
      <div style="width:12px;"></div>
    </div>
  </nav>

  <script>
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
window.RampHelpers = {
  setCookie(name, value, days){
    const d = new Date();
    d.setTime(d.getTime() + (days||365) * 24 * 60 * 60 * 1000);
    document.cookie = name + "=" + encodeURIComponent(value) + ";path=/;expires=" + d.toUTCString();
  },
  getCookie(name){
    const list = document.cookie.split(';').map(c => c.trim());
    for(const pair of list){
      if(pair.indexOf(name + '=') === 0) return decodeURIComponent(pair.split('=').slice(1).join('='));
    }
    return null;
  },
  removeCookie(name){
    document.cookie = name + "=;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";
  }
};
(function(){
  function injectStyles(){
    const css = ".taskbar-hidden{display:none !important;} .taskbar-visible{display:flex !important;}";
    if(!document.getElementById('ramp-dynamic-styles')){
      const s = document.createElement('style');
      s.id = 'ramp-dynamic-styles';
      s.textContent = css;
      document.head.appendChild(s);
    }
  }
  function init(){
    injectStyles();
    const usernameInput = $('#username');
    const signInBtn = $('#signInBtn');
    const panelRoot = $('#app-panel-root');
    const centeredInfo = $('#centeredInfo');
    const startScreen = document.getElementById('start-screen');
    const loadingScreen = document.getElementById('loading-screen');
    const homeScreen = document.getElementById('home-screen');
    if(startScreen && !document.body.classList.contains('hide-bar')) document.body.classList.add('hide-bar');
    const homeDockBtn = document.querySelector('.dock-btn[data-app="home"]');
    if(homeDockBtn) homeDockBtn.remove();
    applySavedBackground();
    applySavedTaskbarPosition();
    applySavedClockFormat();
    applySavedCursor();
    function applySavedBackground(){
      const saved = window.RampHelpers.getCookie('ramp_background');
      if(!saved) return;
      if(saved === 'none'){
        document.body.style.backgroundImage = 'none';
        document.body.style.backgroundColor = '#000';
      } else {
        document.body.style.backgroundImage = `url(${saved})`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundPosition = 'center';
      }
    }
    function applySavedTaskbarPosition(){
      const pos = window.RampHelpers.getCookie('ramp_taskbar') || 'bottom';
      const bar = document.getElementById('bottomBar');
      if(!bar) return;
      if(document.body.classList.contains('hide-bar')){
        bar.style.display = 'none';
        return;
      } else {
        bar.style.display = 'flex';
      }
      bar.style.position = 'fixed';
      bar.style.left = '0';
      bar.style.right = '0';
      bar.style.width = '100%';
      bar.style.height = 'var(--bar-height)';
      bar.style.flexDirection = 'row';
      if(pos === 'top'){
        bar.style.top = '0';
        bar.style.bottom = 'auto';
      } else {
        bar.style.bottom = '0';
        bar.style.top = 'auto';
      }
    }
    function applySavedClockFormat(){
      const fmt = window.RampHelpers.getCookie('ramp_clock_fmt') || '12';
      window.RampClock = { fmt: fmt === '24' ? '24' : '12' };
      startClock();
    }
    function applySavedCursor(){
      const cur = window.RampHelpers.getCookie('ramp_cursor') || 'default';
      const links = {
        default: 'https://raw.githubusercontent.com/hazexxv/cursor/main/cursor.png',
        precision: 'https://raw.githubusercontent.com/hazexxv/cursor/main/precision.png',
        classic: 'https://raw.githubusercontent.com/hazexxv/cursor/main/clicks.png'
      };
      const url = links[cur] || links.default;
      try {
        document.body.style.cursor = `url(${url}) 16 16, auto`;
      } catch(e){
        document.body.style.cursor = 'auto';
      }
    }
    function showHomeOnly(){
      panelRoot.innerHTML = '';
      if(centeredInfo) centeredInfo.style.display = 'block';
      clearActiveDock();
    }
    function showStartScreen(){
      if(startScreen) startScreen.classList.remove('hidden');
      if(homeScreen) homeScreen.classList.add('hidden');
      document.body.classList.add('hide-bar');
      document.querySelectorAll('.dock-btn').forEach(b => b.classList.remove('active'));
      applySavedTaskbarPosition();
    }
    function clearActiveDock(){
      $$('.dock-btn').forEach(b => b.classList.remove('active'));
    }
    function setActiveDock(name){
      clearActiveDock();
      const btn = document.querySelector('.dock-btn[data-app="' + name + '"]');
      if(btn) btn.classList.add('active');
    }
    function cap(s){ if(!s) return s; return s.charAt(0).toUpperCase() + s.slice(1); }
    const panels = {};
    function openAppPanel(app){
      if(!panels[app]) panels[app] = { stack: [ { view: 'main', data: null } ] };
      setActiveDock(app);
      if(centeredInfo) centeredInfo.style.display = 'none';
      renderPanel(app);
    }
    function pushPanelView(app, view, data){
      if(!panels[app]) panels[app] = { stack: [] };
      panels[app].stack.push({ view, data });
      renderPanel(app);
    }
    function popPanelView(app){
      if(!panels[app] || panels[app].stack.length <= 1){
        closePanel(app);
        return false;
      }
      panels[app].stack.pop();
      renderPanel(app);
      return true;
    }
    function closePanel(app){
      if(!panels[app]) return;
      delete panels[app];
      panelRoot.innerHTML = '';
      if(centeredInfo) centeredInfo.style.display = 'block';
      setActiveDock(null);
    }
    function renderPanel(app){
      const p = panels[app];
      if(!p) return;
      const stackTop = p.stack[p.stack.length - 1];
      panelRoot.innerHTML = '';
      const panel = document.createElement('div');
      panel.className = 'app-panel';
      panel.id = 'panel-' + app;
      const inner = document.createElement('div');
      inner.className = 'panel-inner';
      const main = document.createElement('div');
      main.className = 'panel-main';
      const panelTop = document.createElement('div');
      panelTop.className = 'panel-top';
      const leftControls = document.createElement('div');
      leftControls.style.display = 'flex';
      leftControls.style.gap = '8px';
      leftControls.style.alignItems = 'center';
      const backBtn = document.createElement('button');
      backBtn.className = 'icon-btn back';
      backBtn.setAttribute('aria-label', 'Back');
      backBtn.innerText = '◀';
      backBtn.addEventListener('click', () => {
        const popped = popPanelView(app);
        if(!popped) closePanel(app);
      });
      const closeBtn = document.createElement('button');
      closeBtn.className = 'icon-btn';
      closeBtn.setAttribute('aria-label', 'Close');
      closeBtn.innerText = '✕';
      closeBtn.addEventListener('click', () => closePanel(app));
      leftControls.appendChild(backBtn);
      leftControls.appendChild(closeBtn);
      const titleWrap = document.createElement('div');
      titleWrap.className = 'panel-title';
      const username = window.RampHelpers.getCookie('ramp_username') || 'Guest';
      if(stackTop && stackTop.view === 'main'){
        titleWrap.textContent = cap(app) + ' • ' + username;
      } else if(stackTop && stackTop.data && stackTop.data.title){
        titleWrap.textContent = stackTop.data.title + ' • ' + username;
      } else {
        titleWrap.textContent = cap(app);
      }
      panelTop.appendChild(leftControls);
      panelTop.appendChild(titleWrap);
      main.appendChild(panelTop);
      const contentBody = document.createElement('div');
      contentBody.style.paddingTop = '12px';
      if(stackTop.view === 'main'){
        const welcome = document.createElement('div');
        welcome.className = 'welcome-rect';
        welcome.innerHTML = `<h2>Welcome back, ${username}</h2><div style="opacity:0.9">This is the ${app} main page.</div>`;
        contentBody.appendChild(welcome);
        if(app === 'apps' || app === 'games'){
          const gridWrap = document.createElement('div');
          gridWrap.className = 'apps-grid';
          contentBody.appendChild(gridWrap);
          fetchRepoFileList(app, gridWrap);
        } else if(app === 'settings'){
          const grid = document.createElement('div');
          grid.className = 'cat-grid';
          ['API','Connection','Appearance','About'].forEach(cat => {
            const tile = document.createElement('div');
            tile.className = 'cat-tile';
            tile.tabIndex = 0;
            tile.style.minHeight = '140px';
            tile.style.fontSize = '18px';
            tile.textContent = cat;
            tile.addEventListener('click', () => pushPanelView(app, 'sub', { title: cat }));
            tile.addEventListener('keydown', e => { if(e.key === 'Enter') pushPanelView(app, 'sub', { title: cat }); });
            grid.appendChild(tile);
          });
          contentBody.appendChild(grid);
        } else {
          const grid = document.createElement('div');
          grid.className = 'cat-grid';
          const tile = document.createElement('div');
          tile.className = 'cat-tile';
          tile.textContent = 'General';
          tile.tabIndex = 0;
          grid.appendChild(tile);
          contentBody.appendChild(grid);
        }
      } else {
        const title = stackTop.data && stackTop.data.title ? stackTop.data.title : 'Detail';
        const heading = document.createElement('div');
        heading.className = 'welcome-rect';
        heading.innerHTML = `<h2>${title}</h2><div style="opacity:0.85">Hi ${username}, this is the ${title} view.</div>`;
        contentBody.appendChild(heading);
        if(stackTop.data && stackTop.data.title === 'API'){
          const apiWrap = document.createElement('div');
          apiWrap.className = 'api-wrap';
          const services = [
            { name: 'Apps API', status: 'up' },
            { name: 'Games API', status: 'up' },
            { name: 'Movies API', status: 'up' }
          ];
          services.forEach(svc => {
            const row = document.createElement('div');
            row.className = 'api-row';
            const label = document.createElement('div');
            label.className = 'api-label';
            label.textContent = svc.name;
            const status = document.createElement('div');
            status.style.fontWeight = 800;
            status.style.color = svc.status === 'up' ? '#26c281' : '#ffb545';
            status.textContent = svc.status.toUpperCase();
            row.appendChild(label);
            row.appendChild(status);
            apiWrap.appendChild(row);
          });
          contentBody.appendChild(apiWrap);
        } else if(stackTop.data && stackTop.data.title === 'Connection'){
          const netWrap = document.createElement('div');
          netWrap.className = 'network-grid';
          const connCard = document.createElement('div');
          connCard.className = 'network-card';
          connCard.innerHTML = '<div style="font-weight:800">Connection</div><div id="net-info">Loading connection info…</div>';
          netWrap.appendChild(connCard);
          contentBody.appendChild(netWrap);
          populateConnectionInfo(true, connCard);
        } else if(stackTop.data && stackTop.data.title === 'Appearance'){
          const grid = document.createElement('div');
          grid.className = 'cat-grid';
          ['Wallpapers','Customization'].forEach(cat => {
            const tile = document.createElement('div');
            tile.className = 'cat-tile';
            tile.tabIndex = 0;
            tile.style.minHeight = '140px';
            tile.style.fontSize = '18px';
            tile.textContent = cat;
            tile.addEventListener('click', () => {
              if(cat === 'Wallpapers') pushPanelView(app, 'sub', { title: 'Wallpapers' });
              else pushPanelView(app, 'sub', { title: 'Customization' });
            });
            tile.addEventListener('keydown', e => { if(e.key === 'Enter') { if(cat === 'Wallpapers') pushPanelView(app, 'sub', { title: 'Wallpapers' }); else pushPanelView(app, 'sub', { title: 'Customization' }); } });
            grid.appendChild(tile);
          });
          contentBody.appendChild(grid);
        } else if(stackTop.data && stackTop.data.title === 'Wallpapers'){
          const appearance = document.createElement('div');
          appearance.className = 'appearance-grid';
          const urls = [
            'https://raw.githubusercontent.com/hazexxv/covers/main/backgrounds/mountains_theme.jpg',
            'https://raw.githubusercontent.com/hazexxv/covers/main/backgrounds/nighttime_theme.png',
            'https://raw.githubusercontent.com/hazexxv/covers/main/backgrounds/seraph_theme.png',
            'https://raw.githubusercontent.com/hazexxv/covers/main/backgrounds/sunset_theme.jpg'
          ];
          urls.forEach(u => {
            const tile = document.createElement('div');
            tile.className = 'wall-preview';
            tile.style.backgroundImage = `url(${u})`;
            tile.tabIndex = 0;
            tile.addEventListener('click', () => { applyAndSaveBackground(u); });
            tile.addEventListener('keydown', e => { if(e.key === 'Enter') applyAndSaveBackground(u); });
            appearance.appendChild(tile);
          });
          const black = document.createElement('div');
          black.className = 'wall-preview';
          black.textContent = 'Black';
          black.tabIndex = 0;
          black.addEventListener('click', () => { applyAndSaveBackground('none'); });
          appearance.appendChild(black);
          contentBody.appendChild(appearance);
        } else if(stackTop.data && stackTop.data.title === 'Customization'){
          const wrap = document.createElement('div');
          wrap.className = 'cat-grid';
          const taskbarTile = document.createElement('div');
          taskbarTile.className = 'cat-tile';
          taskbarTile.tabIndex = 0;
          taskbarTile.innerHTML = '<div style="font-weight:800;margin-bottom:8px">Taskbar Position</div>';
          const taskOpts = document.createElement('div');
          taskOpts.style.display = 'grid';
          taskOpts.style.gridTemplateColumns = 'repeat(2,1fr)';
          taskOpts.style.gap = '8px';
          ['bottom','top'].forEach(pos => {
            const b = document.createElement('button');
            b.className = 'btn';
            b.textContent = pos.charAt(0).toUpperCase() + pos.slice(1);
            b.addEventListener('click', () => { window.RampHelpers.setCookie('ramp_taskbar', pos, 365); applySavedTaskbarPosition(); });
            taskOpts.appendChild(b);
          });
          taskbarTile.appendChild(taskOpts);
          wrap.appendChild(taskbarTile);
          const clockTile = document.createElement('div');
          clockTile.className = 'cat-tile';
          clockTile.tabIndex = 0;
          clockTile.innerHTML = '<div style="font-weight:800;margin-bottom:8px">Clock Format (seconds shown)</div>';
          const clockOpts = document.createElement('div');
          clockOpts.style.display = 'flex';
          clockOpts.style.gap = '8px';
          const c12 = document.createElement('button');
          const c24 = document.createElement('button');
          c12.className = 'btn';
          c24.className = 'btn';
          c12.textContent = '12 hour';
          c24.textContent = '24 hour';
          c12.addEventListener('click', () => { window.RampHelpers.setCookie('ramp_clock_fmt', '12', 365); applySavedClockFormat(); });
          c24.addEventListener('click', () => { window.RampHelpers.setCookie('ramp_clock_fmt', '24', 365); applySavedClockFormat(); });
          clockOpts.appendChild(c12);
          clockOpts.appendChild(c24);
          clockTile.appendChild(clockOpts);
          wrap.appendChild(clockTile);
          contentBody.appendChild(wrap);
        } else if(stackTop.data && stackTop.data.title === 'About'){
          const about = document.createElement('div');
          about.className = 'about-list';
          about.innerHTML = '<div><strong>Owner</strong>: Christian Hall</div><div><strong>Contact</strong>: haze_vv (Discord)</div><div><strong>Email</strong>: ch5962009@gmail.com</div><div><strong>Created</strong>: 10.6.25</div>';
          contentBody.appendChild(about);
        } else if(stackTop.data && stackTop.data.xmlEmbedUrl){
          const embedWrap = document.createElement('div');
          embedWrap.className = 'embed-area';
          const toolbar = document.createElement('div');
          toolbar.className = 'embed-toolbar';
          const fsBtn = document.createElement('button');
          fsBtn.className = 'fullscreen-btn';
          fsBtn.textContent = 'Fullscreen';
          toolbar.appendChild(fsBtn);
          embedWrap.appendChild(toolbar);
          const iframe = document.createElement('iframe');
          iframe.className = 'embed-viewport';
          iframe.setAttribute('sandbox','allow-scripts allow-same-origin');
          iframe.src = stackTop.data.xmlEmbedUrl;
          embedWrap.appendChild(iframe);
          fsBtn.addEventListener('click', () => {
            if(iframe.requestFullscreen) iframe.requestFullscreen();
            else if(iframe.webkitRequestFullscreen) iframe.webkitRequestFullscreen();
          });
          contentBody.appendChild(embedWrap);
        } else {
          const sample = document.createElement('div');
          sample.style.marginTop = '12px';
          sample.innerHTML = `<div style="opacity:0.85">Example content for ${title}</div>`;
          contentBody.appendChild(sample);
        }
      }
      main.appendChild(contentBody);
      inner.appendChild(main);
      panel.appendChild(inner);
      panelRoot.appendChild(panel);
      const currentStack = (panels[app] && panels[app].stack) ? panels[app].stack : [];
      const backBtnDom = panel.querySelector('.icon-btn.back');
      if(backBtnDom) backBtnDom.style.opacity = (currentStack.length <= 1) ? '0.5' : '1';
    }
    function applyAndSaveBackground(value){
      if(value === 'none'){
        document.body.style.backgroundImage = 'none';
        document.body.style.backgroundColor = '#000';
        window.RampHelpers.setCookie('ramp_background', 'none', 365);
      } else {
        document.body.style.backgroundImage = `url(${value})`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundPosition = 'center';
        window.RampHelpers.setCookie('ramp_background', value, 365);
      }
    }
    function fetchRepoFileList(app, gridWrap){
      const repoApi = 'https://api.github.com/repos/hazexxv/' + (app === 'apps' ? 'apps' : 'games') + '/contents/';
      fetch(repoApi).then(r => r.json()).then(list => {
        if(!Array.isArray(list)) throw new Error('Invalid repo response');
        const files = list.filter(f => f.name && (f.name.toLowerCase().endsWith('.xml') || f.name.toLowerCase().endsWith('.html')));
        files.forEach(f => {
          const item = document.createElement('div');
          item.className = 'app-item';
          item.tabIndex = 0;
          item.textContent = f.name;
          item.addEventListener('click', () => openXmlEmbed(app, f.download_url, f.name));
          item.addEventListener('keydown', (e) => { if(e.key === 'Enter') openXmlEmbed(app, f.download_url, f.name); });
          gridWrap.appendChild(item);
        });
      }).catch(() => {
        const err = document.createElement('div');
        err.textContent = 'Failed to list repository files';
        gridWrap.appendChild(err);
      });
    }
    function renderMoviesGrid(container){
      container.innerHTML = '<div style="opacity:0.85">Movies removed</div>';
    }
    function ensureContainerId(el){
      if(!el.id){
        el.id = 'movies-grid-' + Math.random().toString(36).slice(2,9);
      }
      return el.id;
    }
    function openXmlEmbed(app, rawUrl, name){
      fetch(rawUrl).then(r => r.text()).then(txt => {
        const blob = new Blob([txt], { type: 'text/html' });
        const blobUrl = URL.createObjectURL(blob);
        pushPanelView(app, 'sub', { title: name, xmlEmbedUrl: blobUrl });
      }).catch(() => {
        pushPanelView(app, 'sub', { title: name, xmlEmbedUrl: null });
      });
    }
    function populateConnectionInfo(autoload, containerEl){
      const el = containerEl ? containerEl.querySelector('#net-info') : document.getElementById('net-info');
      if(!el) return;
      const lines = [];
      lines.push(`Online: ${navigator.onLine ? 'yes' : 'no'}`);
      const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection || null;
      lines.push(`Type: ${conn && conn.effectiveType ? conn.effectiveType : 'ethernet'}`);
      lines.push(`Downlink Mbps: ${conn && conn.downlink ? conn.downlink : '100'}`);
      lines.push(`RTT ms: ${conn && conn.rtt ? conn.rtt : '10'}`);
      lines.push(`Live: true`);
      lines.push(`Verified: true`);
      el.innerHTML = lines.map(l => `<div style="padding-top:6px;">${l}</div>`).join('');
      if(autoload){
        window.setTimeout(() => { populateConnectionInfo(false, containerEl); }, 3000);
      }
    }
    window.RampRefreshConnection = () => populateConnectionInfo(false);
    function startClock(){
      const homeClock = document.getElementById('homeClock');
      const barTime = document.getElementById('barTime');
      function pad(n){ return n < 10 ? '0' + n : n; }
      function tick(){
        const now = new Date();
        const fmt = (window.RampClock && window.RampClock.fmt) ? window.RampClock.fmt : '12';
        let hh = now.getHours();
        let ampm = '';
        if(fmt === '12'){
          ampm = hh >= 12 ? ' PM' : ' AM';
          hh = hh % 12;
          if(hh === 0) hh = 12;
        }
        const mm = pad(now.getMinutes());
        const ss = pad(now.getSeconds());
        const timeStr = `${hh}:${mm}:${ss}${fmt === '12' ? ampm : ''}`;
        if(homeClock) homeClock.textContent = timeStr;
        if(barTime) barTime.textContent = timeStr;
      }
      tick();
      setInterval(tick, 1000);
    }
    function findDockBtn(el){ return el && el.closest ? el.closest('.dock-btn') : null; }
    document.addEventListener('pointerup', e => {
      const dock = findDockBtn(e.target);
      if(dock){
        e.preventDefault();
        const app = dock.dataset.app;
        if(!app) return;
        dock.classList.add('active');
        openAppPanel(app);
      }
    }, { capture: true });
    document.addEventListener('click', e => {
      const dock = findDockBtn(e.target);
      if(dock){
        const app = dock.dataset.app;
        if(!app) return;
        dock.classList.add('active');
        openAppPanel(app);
      }
    });
    document.addEventListener('keydown', e => {
      const active = document.activeElement;
      if(active && active.classList && active.classList.contains('dock-btn') && (e.key === 'Enter' || e.key === ' ')){
        e.preventDefault();
        const app = active.dataset.app;
        if(!app) return;
        active.classList.add('active');
        openAppPanel(app);
      }
      if(e.key === 'Escape'){
        const keys = Object.keys(panels);
        if(keys.length){
          const last = keys[keys.length - 1];
          closePanel(last);
        }
      }
    });
    if(signInBtn) signInBtn.addEventListener('click', enterOS);
    if(usernameInput) usernameInput.addEventListener('keydown', e => { if(e.key === 'Enter') enterOS(); });
    function enterOS(){
      const name = usernameInput && usernameInput.value.trim() ? usernameInput.value.trim() : (window.RampHelpers.getCookie('ramp_username') || 'Guest');
      window.RampHelpers.setCookie('ramp_username', name, 365);
      const loading = document.getElementById('loading-screen');
      const start = document.getElementById('start-screen');
      const home = document.getElementById('home-screen');
      if(loading) loading.classList.remove('hidden');
      setTimeout(function(){
        if(loading) loading.classList.add('hidden');
        if(start) start.classList.add('hidden');
        if(home) home.classList.remove('hidden');
        document.body.classList.remove('hide-bar');
        applySavedTaskbarPosition();
        document.querySelectorAll('.dock-btn').forEach(function(b){ b.classList.remove('active'); });
      }, 300);
    }
    if(signInBtn) signInBtn.addEventListener('click', () => {
      const name = usernameInput && usernameInput.value.trim() ? usernameInput.value.trim() : (window.RampHelpers.getCookie('ramp_username') || 'Guest');
      window.RampHelpers.setCookie('ramp_username', name, 365);
    });
    if(usernameInput) usernameInput.addEventListener('keydown', e => {
      if(e.key === 'Enter'){
        const name = usernameInput.value.trim() ? usernameInput.value.trim() : (window.RampHelpers.getCookie('ramp_username') || 'Guest');
        window.RampHelpers.setCookie('ramp_username', name, 365);
      }
    });
    const savedName = window.RampHelpers.getCookie('ramp_username');
    if(savedName && $('#username')) $('#username').value = savedName;
    showHomeOnly();
  }
  if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
  else init();
})();
  </script>
</body>
</html>
